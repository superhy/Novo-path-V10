load model from: D:/FLINC_dataset/slides/yang_cd45_u\models\checkpoint_ViT-6-8-PT-Dino_unsupervised-16x16[50]2023-01-13.pth
>> copy layer: backbone.pos_embedding
>> copy layer: backbone.cls_token
>> copy layer: backbone.to_patch_embedding.1.bias
>> copy layer: backbone.transformer.layers.0.0.norm.weight
>> copy layer: backbone.transformer.layers.0.0.norm.bias
>> copy layer: backbone.transformer.layers.0.0.fn.to_qkv.weight
>> copy layer: backbone.transformer.layers.0.0.fn.to_out.0.weight
>> copy layer: backbone.transformer.layers.0.0.fn.to_out.0.bias
>> copy layer: backbone.transformer.layers.0.1.norm.weight
>> copy layer: backbone.transformer.layers.0.1.norm.bias
>> copy layer: backbone.transformer.layers.0.1.fn.net.0.weight
>> copy layer: backbone.transformer.layers.0.1.fn.net.0.bias
>> copy layer: backbone.transformer.layers.0.1.fn.net.3.weight
>> copy layer: backbone.transformer.layers.0.1.fn.net.3.bias
>> copy layer: backbone.transformer.layers.1.0.norm.weight
>> copy layer: backbone.transformer.layers.1.0.norm.bias
>> copy layer: backbone.transformer.layers.1.0.fn.to_qkv.weight
>> copy layer: backbone.transformer.layers.1.0.fn.to_out.0.weight
>> copy layer: backbone.transformer.layers.1.0.fn.to_out.0.bias
>> copy layer: backbone.transformer.layers.1.1.norm.weight
>> copy layer: backbone.transformer.layers.1.1.norm.bias
>> copy layer: backbone.transformer.layers.1.1.fn.net.0.weight
>> copy layer: backbone.transformer.layers.1.1.fn.net.0.bias
>> copy layer: backbone.transformer.layers.1.1.fn.net.3.weight
>> copy layer: backbone.transformer.layers.1.1.fn.net.3.bias
>> copy layer: backbone.transformer.layers.2.0.norm.weight
>> copy layer: backbone.transformer.layers.2.0.norm.bias
>> copy layer: backbone.transformer.layers.2.0.fn.to_qkv.weight
>> copy layer: backbone.transformer.layers.2.0.fn.to_out.0.weight
>> copy layer: backbone.transformer.layers.2.0.fn.to_out.0.bias
>> copy layer: backbone.transformer.layers.2.1.norm.weight
>> copy layer: backbone.transformer.layers.2.1.norm.bias
>> copy layer: backbone.transformer.layers.2.1.fn.net.0.weight
>> copy layer: backbone.transformer.layers.2.1.fn.net.0.bias
>> copy layer: backbone.transformer.layers.2.1.fn.net.3.weight
>> copy layer: backbone.transformer.layers.2.1.fn.net.3.bias
>> copy layer: backbone.transformer.layers.3.0.norm.weight
>> copy layer: backbone.transformer.layers.3.0.norm.bias
>> copy layer: backbone.transformer.layers.3.0.fn.to_qkv.weight
>> copy layer: backbone.transformer.layers.3.0.fn.to_out.0.weight
>> copy layer: backbone.transformer.layers.3.0.fn.to_out.0.bias
>> copy layer: backbone.transformer.layers.3.1.norm.weight
>> copy layer: backbone.transformer.layers.3.1.norm.bias
>> copy layer: backbone.transformer.layers.3.1.fn.net.0.weight
>> copy layer: backbone.transformer.layers.3.1.fn.net.0.bias
>> copy layer: backbone.transformer.layers.3.1.fn.net.3.weight
>> copy layer: backbone.transformer.layers.3.1.fn.net.3.bias
reuse model from: D:/FLINC_dataset/slides/yang_cd45_u\models\checkpoint_ViT-Region-4-6-PT-Dino_unsupervised-9x9[50]2023-04-04.pth
![Initial Stage] clustering mode
Initialising the embedding of overall tile features...
load region ctx for tile 23910-158_Sl251-C2-CD45 1 347 region_ctx_nd: (256, 9, 9)
combine region prior and tile: torch.Size([337]) torch.Size([256]) ...
82709 tiles' regional context combined encodes have been loaded, take 0:19:14.849665 sec
store 82709 tiles rich tuples at: D:/eclipse-workspace\Novo-path-V10\data/CD45_unsupervised/encodes/256-0/train_encode\ViT-6-8-region_ctx_2023-04-05.pkl
data tuples loaded!
Using clustering: Kmeans
In fitting...execute Kmeans clustering on 82709 tiles with time: 0:00:06.655886 sec
store the clustering results at: D:/FLINC_dataset/slides/yang_cd45_u\models / clst-res_Kmeans-region_ctx_unsupervised2023-04-05.pkl
store the clustering model at: D:/FLINC_dataset/slides/yang_cd45_u\models / clst-model_Kmeans-region_ctx_unsupervised2023-04-05.pkl
clustering number of centres: 6
{1: 9009, 4: 12604, 5: 9323, 3: 23205, 2: 11369, 0: 17193}
